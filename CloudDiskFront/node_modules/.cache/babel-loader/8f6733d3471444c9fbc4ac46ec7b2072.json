{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.array.push.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.objectToString = void 0;\n\nconst quote_1 = require(\"./quote\");\n\nconst function_1 = require(\"./function\");\n\nconst array_1 = require(\"./array\");\n/**\n * Transform an object into a string.\n */\n\n\nconst objectToString = (value, space, next, key) => {\n  // Support buffer in all environments.\n  if (typeof Buffer === \"function\" && Buffer.isBuffer(value)) {\n    return `Buffer.from(${next(value.toString(\"base64\"))}, 'base64')`;\n  } // Support `global` under test environments that don't print `[object global]`.\n\n\n  if (typeof global === \"object\" && value === global) {\n    return globalToString(value, space, next, key);\n  } // Use the internal object string to select stringify method.\n\n\n  const toString = OBJECT_TYPES[Object.prototype.toString.call(value)];\n  return toString ? toString(value, space, next, key) : undefined;\n};\n\nexports.objectToString = objectToString;\n/**\n * Stringify an object of keys and values.\n */\n\nconst rawObjectToString = (obj, indent, next, key) => {\n  const eol = indent ? \"\\n\" : \"\";\n  const space = indent ? \" \" : \"\"; // Iterate over object keys and concat string together.\n\n  const values = Object.keys(obj).reduce(function (values, key) {\n    const fn = obj[key];\n    const result = next(fn, key); // Omit `undefined` object entries.\n\n    if (result === undefined) return values; // String format the value data.\n\n    const value = result.split(\"\\n\").join(`\\n${indent}`); // Skip `key` prefix for function parser.\n\n    if (function_1.USED_METHOD_KEY.has(fn)) {\n      values.push(`${indent}${value}`);\n      return values;\n    }\n\n    values.push(`${indent}${quote_1.quoteKey(key, next)}:${space}${value}`);\n    return values;\n  }, []).join(`,${eol}`); // Avoid new lines in an empty object.\n\n  if (values === \"\") return \"{}\";\n  return `{${eol}${values}${eol}}`;\n};\n/**\n * Stringify global variable access.\n */\n\n\nconst globalToString = (value, space, next) => {\n  return `Function(${next(\"return this\")})()`;\n};\n/**\n * Convert JavaScript objects into strings.\n */\n\n\nconst OBJECT_TYPES = {\n  \"[object Array]\": array_1.arrayToString,\n  \"[object Object]\": rawObjectToString,\n  \"[object Error]\": (error, space, next) => {\n    return `new Error(${next(error.message)})`;\n  },\n  \"[object Date]\": date => {\n    return `new Date(${date.getTime()})`;\n  },\n  \"[object String]\": (str, space, next) => {\n    return `new String(${next(str.toString())})`;\n  },\n  \"[object Number]\": num => {\n    return `new Number(${num})`;\n  },\n  \"[object Boolean]\": bool => {\n    return `new Boolean(${bool})`;\n  },\n  \"[object Set]\": (set, space, next) => {\n    return `new Set(${next(Array.from(set))})`;\n  },\n  \"[object Map]\": (map, space, next) => {\n    return `new Map(${next(Array.from(map))})`;\n  },\n  \"[object RegExp]\": String,\n  \"[object global]\": globalToString,\n  \"[object Window]\": globalToString\n};","map":{"version":3,"mappings":"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","names":["objectToString","value","space","next","key","Buffer","isBuffer","toString","global","globalToString","OBJECT_TYPES","Object","prototype","call","undefined","exports","rawObjectToString","obj","indent","eol","values","keys","reduce","fn","result","split","join","function_1","has","push","quote_1","array_1","error","message","date","getTime","str","num","bool","set","Array","from","map","String"],"sourceRoot":"","sources":["../src/object.ts"],"sourcesContent":["import { Next, ToString } from \"./types\";\nimport { quoteKey } from \"./quote\";\nimport { USED_METHOD_KEY } from \"./function\";\nimport { arrayToString } from \"./array\";\n\n/**\n * Transform an object into a string.\n */\nexport const objectToString: ToString = (value, space, next, key) => {\n  // Support buffer in all environments.\n  if (typeof Buffer === \"function\" && Buffer.isBuffer(value)) {\n    return `Buffer.from(${next(value.toString(\"base64\"))}, 'base64')`;\n  }\n\n  // Support `global` under test environments that don't print `[object global]`.\n  if (typeof global === \"object\" && value === global) {\n    return globalToString(value, space, next, key);\n  }\n\n  // Use the internal object string to select stringify method.\n  const toString = OBJECT_TYPES[Object.prototype.toString.call(value)];\n  return toString ? toString(value, space, next, key) : undefined;\n};\n\n/**\n * Stringify an object of keys and values.\n */\nconst rawObjectToString: ToString = (obj, indent, next, key) => {\n  const eol = indent ? \"\\n\" : \"\";\n  const space = indent ? \" \" : \"\";\n\n  // Iterate over object keys and concat string together.\n  const values = Object.keys(obj)\n    .reduce(function (values, key) {\n      const fn = obj[key];\n      const result = next(fn, key);\n\n      // Omit `undefined` object entries.\n      if (result === undefined) return values;\n\n      // String format the value data.\n      const value = result.split(\"\\n\").join(`\\n${indent}`);\n\n      // Skip `key` prefix for function parser.\n      if (USED_METHOD_KEY.has(fn)) {\n        values.push(`${indent}${value}`);\n        return values;\n      }\n\n      values.push(`${indent}${quoteKey(key, next)}:${space}${value}`);\n      return values;\n    }, [] as string[])\n    .join(`,${eol}`);\n\n  // Avoid new lines in an empty object.\n  if (values === \"\") return \"{}\";\n\n  return `{${eol}${values}${eol}}`;\n};\n\n/**\n * Stringify global variable access.\n */\nconst globalToString: ToString = (value, space, next) => {\n  return `Function(${next(\"return this\")})()`;\n};\n\n/**\n * Convert JavaScript objects into strings.\n */\nconst OBJECT_TYPES: Record<string, ToString> = {\n  \"[object Array]\": arrayToString,\n  \"[object Object]\": rawObjectToString,\n  \"[object Error]\": (error: Error, space: string, next: Next) => {\n    return `new Error(${next(error.message)})`;\n  },\n  \"[object Date]\": (date: Date) => {\n    return `new Date(${date.getTime()})`;\n  },\n  \"[object String]\": (str: string, space: string, next: Next) => {\n    return `new String(${next(str.toString())})`;\n  },\n  \"[object Number]\": (num: number) => {\n    return `new Number(${num})`;\n  },\n  \"[object Boolean]\": (bool: boolean) => {\n    return `new Boolean(${bool})`;\n  },\n  \"[object Set]\": (set: Set<any>, space: string, next: Next) => {\n    return `new Set(${next(Array.from(set))})`;\n  },\n  \"[object Map]\": (map: Map<any, any>, space: string, next: Next) => {\n    return `new Map(${next(Array.from(map))})`;\n  },\n  \"[object RegExp]\": String,\n  \"[object global]\": globalToString,\n  \"[object Window]\": globalToString,\n};\n"]},"metadata":{},"sourceType":"script"}