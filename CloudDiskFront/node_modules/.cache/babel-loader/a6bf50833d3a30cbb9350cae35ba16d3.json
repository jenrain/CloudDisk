{"ast":null,"code":"// 剪切板插件\nimport ClipboardJS from \"clipboard\";\nnew ClipboardJS(\".btn\");\nexport default {\n  name: \"shareDialog\",\n\n  data() {\n    return {\n      // 是否显示分享框\n      isShow: this.isShareDialogShow,\n      // 用于展示的数据\n      showItem: {}\n    };\n  },\n\n  props: {\n    // 是否显示分享框\n    isShareDialogShow: {\n      type: Boolean,\n\n      default() {\n        return false;\n      }\n\n    },\n    // 分享的文件对象\n    shareItem: {\n      type: Object,\n\n      default() {\n        return {};\n      }\n\n    }\n  },\n  methods: {\n    // 请求\n    // 根据vid请求对应的url\n    async getVideoUrl() {\n      let res = await this.$request(\"/eduoss/fileoss/getPlayAuth?isList=\" + this.shareItem.videoId, \"\", \"post\");\n      return res.data.data.urlList[0].url;\n    }\n\n  },\n  watch: {\n    async isShareDialogShow(current) {\n      this.isShow = current;\n\n      if (current == true) {\n        if (this.shareItem.filetype == \"audio\" || this.shareItem.filetype == \"video\") {\n          // 如果是音频或视频类型 则重新获取url 以保证url有效期\n          let url = await this.getVideoUrl();\n          this.showItem = this.shareItem;\n          this.showItem.url = url;\n        } else {\n          this.showItem = this.shareItem;\n        }\n      }\n    }\n\n  },\n  computed: {}\n};","map":{"version":3,"mappings":"AA2BA;AACA;AACA;AAEA;EACAA,mBADA;;EAEAC;IACA;MACA;MACAC,8BAFA;MAGA;MACAC;IAJA;EAMA,CATA;;EAUAC;IACA;IACAC;MACAC,aADA;;MAEAC;QACA;MACA;;IAJA,CAFA;IAQA;IACAC;MACAF,YADA;;MAEAC;QACA;MACA;;IAJA;EATA,CAVA;EA0BAE;IACA;IACA;IACA;MACA,8BACA,8DADA,EAEA,EAFA,EAGA,MAHA;MAKA;IACA;;EAVA,CA1BA;EAsCAC;IACA;MACA;;MACA;QACA,IACA,sCACA,kCAFA,EAGA;UACA;UACA;UACA;UACA;QACA,CARA,MAQA;UACA;QACA;MACA;IACA;;EAhBA,CAtCA;EAwDAC;AAxDA","names":["name","data","isShow","showItem","props","isShareDialogShow","type","default","shareItem","methods","watch","computed"],"sourceRoot":"src/components","sources":["ShareDialog.vue"],"sourcesContent":["<template>\r\n  <el-dialog\r\n    custom-class=\"shareDialog\"\r\n    :title=\"'分享文件: ' + shareItem.name + '.' + shareItem.type\"\r\n    :visible.sync=\"isShow\"\r\n    @close=\"\r\n      () => {\r\n        $emit('closeDialog');\r\n        showItem = {};\r\n      }\r\n    \"\r\n  >\r\n    <input class=\"urlInput\" v-model=\"showItem.url\" readonly />\r\n    <el-button\r\n      size=\"small\"\r\n      type=\"primary\"\r\n      data-clipboard-target=\".urlInput\"\r\n      class=\"btn\"\r\n      >复制链接</el-button\r\n    >\r\n    <div slot=\"footer\" class=\"dialog-footer\">\r\n      tips: 请复制上述链接以分享文件\r\n    </div>\r\n  </el-dialog>\r\n</template>\r\n\r\n<script>\r\n// 剪切板插件\r\nimport ClipboardJS from \"clipboard\";\r\nnew ClipboardJS(\".btn\");\r\n\r\nexport default {\r\n  name: \"shareDialog\",\r\n  data() {\r\n    return {\r\n      // 是否显示分享框\r\n      isShow: this.isShareDialogShow,\r\n      // 用于展示的数据\r\n      showItem: {},\r\n    };\r\n  },\r\n  props: {\r\n    // 是否显示分享框\r\n    isShareDialogShow: {\r\n      type: Boolean,\r\n      default() {\r\n        return false;\r\n      },\r\n    },\r\n    // 分享的文件对象\r\n    shareItem: {\r\n      type: Object,\r\n      default() {\r\n        return {};\r\n      },\r\n    },\r\n  },\r\n  methods: {\r\n    // 请求\r\n    // 根据vid请求对应的url\r\n    async getVideoUrl() {\r\n      let res = await this.$request(\r\n        \"/eduoss/fileoss/getPlayAuth?isList=\" + this.shareItem.videoId,\r\n        \"\",\r\n        \"post\"\r\n      );\r\n      return res.data.data.urlList[0].url;\r\n    },\r\n  },\r\n  watch: {\r\n    async isShareDialogShow(current) {\r\n      this.isShow = current;\r\n      if (current == true) {\r\n        if (\r\n          this.shareItem.filetype == \"audio\" ||\r\n          this.shareItem.filetype == \"video\"\r\n        ) {\r\n          // 如果是音频或视频类型 则重新获取url 以保证url有效期\r\n          let url = await this.getVideoUrl();\r\n          this.showItem = this.shareItem;\r\n          this.showItem.url = url;\r\n        } else {\r\n          this.showItem = this.shareItem;\r\n        }\r\n      }\r\n    },\r\n  },\r\n  computed: {},\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.el-button {\r\n  padding: 10px 60px;\r\n  border-radius: 20px;\r\n  margin-top: 20px;\r\n}\r\n\r\n.urlInput {\r\n  display: block;\r\n  width: 90%;\r\n  height: 35px;\r\n  border-radius: 7px;\r\n  outline: none;\r\n  border: 1px solid #ccc;\r\n  color: rgb(87, 87, 87);\r\n  padding: 0 10px;\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}