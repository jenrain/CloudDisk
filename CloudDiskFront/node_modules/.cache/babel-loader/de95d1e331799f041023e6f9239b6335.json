{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport IconTypeList from \"./IconTypeList.vue\";\nexport default {\n  name: \"FolderDialog\",\n  components: {\n    IconTypeList\n  },\n  props: {\n    isFolderDialogShow: {\n      type: Boolean,\n\n      default() {\n        return false;\n      }\n\n    },\n    moveType: {\n      type: String,\n\n      default() {\n        return \"current\";\n      }\n\n    }\n  },\n\n  data() {\n    return {\n      folderList: [],\n      // 显示规则\n      showProps: {\n        children: \"childrenList\",\n        label: data => {\n          return data.name.slice(0, data.name.length - 1);\n        }\n      },\n      //   选中的文件夹名称\n      selectFolder: \"\"\n    };\n  },\n\n  methods: {\n    handleFolderList() {\n      console.log(\"你好\");\n      this.$axios.defaults.headers.common[\"Authorization\"] = window.localStorage.getItem(\"token\");\n      this.$axios({\n        url: \"/user/folder/list\",\n        method: \"post\",\n        data: {}\n      }).then(res => {\n        console.log(res.data);\n\n        if (res.data.success) {\n          // 先拿到根目录的所有文件夹\n          for (let i = 0; i < res.data.folder_list.length; i++) {} // for (let i = 0; i < res.data.folder_list.length; i++) {\n          //   this.folderList.push({\n          //     id: res.data.folder_list[i].id,\n          //     label: res.data.folder_list[i].name + \" \",\n          //     children: [],\n          //   })\n          // }\n          // this.folderList[0].children.push({\n          //     id: 5,\n          //     label: \"摇滚\",\n          //     children: [],\n          // })\n          // console.log(\"测试2：\", this.folderList[0].children[0].label);\n\n        } else {\n          this.$message.error(\"文件请求失败\");\n        }\n      });\n    },\n\n    getFullPath(node, path) {\n      if (node != null) {\n        path = node.parent.data.name + path;\n        return this.getFullPath(node.parent, path);\n      } else {\n        return path;\n      }\n    },\n\n    // js递归遍历树形json数据，根据关键字查找节点\n    //@leafId  查找的id，\n    //@nodes   原始Json数据\n    //@path    供递归使用\n    findPathByLeafId(leafId, nodes, path) {\n      if (path === undefined) {\n        path = [];\n      }\n\n      for (var i = 0; i < nodes.length; i++) {\n        var tmpPath = path.concat();\n        tmpPath.push(nodes[i].name);\n\n        if (leafId == nodes[i].name) {\n          return tmpPath;\n        }\n\n        if (nodes[i].childrenList) {\n          var findResult = this.findPathByLeafId(leafId, nodes[i].childrenList, tmpPath);\n\n          if (findResult) {\n            return findResult;\n          }\n        }\n      }\n    },\n\n    handleNodeClick(e, node) {\n      console.log(e, node); //   this.selectFolder = e.parent.name.slice(0, e.parent.name.length - 1);\n\n      let path = (\"/\" + this.findPathByLeafId(e.name, [this.folderList]).join(\"\")).slice(0, this.findPathByLeafId(e.name, [this.folderList]).join(\"\").length); //   console.log(path);\n\n      this.selectFolder = path;\n    },\n\n    // 点击确定的回调\n    confirmMove() {\n      // 关闭选择框\n      this.$emit(\"closeFolderDialog\"); // 将选中的文件夹名称发给父组件\n\n      this.$emit(\"confirmMove\", {\n        path: this.selectFolder,\n        type: this.moveType\n      });\n    }\n\n  },\n  watch: {\n    isFolderDialogShow(current) {\n      if (current) {\n        this.handleFolderList();\n      }\n    }\n\n  },\n\n  created() {}\n\n};","map":{"version":3,"mappings":";AA8BA;AAEA;EACAA,oBADA;EAEAC;IACAC;EADA,CAFA;EAKAC;IACAC;MACAC,aADA;;MAEAC;QACA;MACA;;IAJA,CADA;IAOAC;MACAF,YADA;;MAEAC;QACA;MACA;;IAJA;EAPA,CALA;;EAmBAE;IACA;MACAC,cADA;MAEA;MACAC;QACAC,wBADA;QAEAC;UACA;QACA;MAJA,CAHA;MAUA;MACAC;IAXA;EAeA,CAnCA;;EAoCAC;IACAC;MACAC;MACA;MACA;QACAC,wBADA;QAEAC,cAFA;QAGAV;MAHA,GAKAW,IALA,CAKAC;QACAJ;;QACA;UACA;UACA,uDAEA,CAJA,CAKA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;QAEA,CAnBA,MAmBA;UACA;QACA;MACA,CA7BA;IA8BA,CAlCA;;IAoCAK;MACA;QACAC;QACA;MACA,CAHA,MAGA;QACA;MACA;IACA,CA3CA;;IA6CA;IACA;IACA;IACA;IACAC;MACA;QACAD;MACA;;MACA;QACA;QACAE;;QACA;UACA;QACA;;QACA;UACA,uCACAC,MADA,EAEAC,qBAFA,EAGAF,OAHA;;UAKA;YACA;UACA;QACA;MACA;IACA,CAtEA;;IAwEAG;MACAX,qBADA,CAEA;;MACA,YACA,+DADA,EAEAY,KAFA,CAGA,CAHA,EAIA,gEAJA,EAHA,CASA;;MACA;IACA,CAnFA;;IAqFA;IACAC;MACA;MACA,gCAFA,CAGA;;MACA;QACAP,uBADA;QAEAjB;MAFA;IAIA;;EA9FA,CApCA;EAoIAyB;IACA1B;MACA;QACA;MACA;IACA;;EALA,CApIA;;EA2IA2B,WAEA;;AA7IA","names":["name","components","IconTypeList","props","isFolderDialogShow","type","default","moveType","data","folderList","showProps","children","label","selectFolder","methods","handleFolderList","console","url","method","then","res","getFullPath","path","findPathByLeafId","tmpPath","leafId","nodes","handleNodeClick","slice","confirmMove","watch","created"],"sourceRoot":"src/components","sources":["FolderDialog.vue"],"sourcesContent":["<template>\r\n  <div class=\"FolderDialog\">\r\n    <el-dialog\r\n      title=\"移动到\"\r\n      width=\"300px\"\r\n      :visible.sync=\"isFolderDialogShow\"\r\n      @close=\"$emit('closeFolderDialog')\"\r\n    >\r\n      <el-tree\r\n        highlight-current\r\n        :data=\"folderList\"\r\n        :props=\"defaultProps\"\r\n        @node-click=\"handleNodeClick\"\r\n      ></el-tree>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button\r\n          @click=\"$emit('closeFolderDialog')\"\r\n          size=\"mini\"\r\n          class=\"cancel\"\r\n          >取 消</el-button\r\n        >\r\n        <el-button @click=\"confirmMove\" size=\"mini\" class=\"confirm\"\r\n          >确 定</el-button\r\n        >\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport IconTypeList from \"./IconTypeList.vue\";\r\n\r\nexport default {\r\n  name: \"FolderDialog\",\r\n  components: {\r\n    IconTypeList,\r\n  },\r\n  props: {\r\n    isFolderDialogShow: {\r\n      type: Boolean,\r\n      default() {\r\n        return false;\r\n      },\r\n    },\r\n    moveType: {\r\n      type: String,\r\n      default() {\r\n        return \"current\";\r\n      },\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      folderList: [],\r\n      // 显示规则\r\n      showProps: {\r\n        children: \"childrenList\",\r\n        label: (data) => {\r\n          return data.name.slice(0, data.name.length - 1);\r\n        },\r\n      },\r\n\r\n      //   选中的文件夹名称\r\n      selectFolder: \"\",\r\n\r\n      \r\n    };\r\n  },\r\n  methods: {\r\n    handleFolderList() {\r\n      console.log(\"你好\");\r\n        this.$axios.defaults.headers.common[\"Authorization\"] = window.localStorage.getItem(\"token\");\r\n        this.$axios({\r\n          url: \"/user/folder/list\",\r\n          method: \"post\",\r\n          data: {\r\n          }\r\n        }).then((res) => {\r\n          console.log(res.data);\r\n          if (res.data.success) {\r\n            // 先拿到根目录的所有文件夹\r\n            for (let i = 0; i < res.data.folder_list.length; i++) {\r\n              \r\n            }\r\n            // for (let i = 0; i < res.data.folder_list.length; i++) {\r\n            //   this.folderList.push({\r\n            //     id: res.data.folder_list[i].id,\r\n            //     label: res.data.folder_list[i].name + \" \",\r\n            //     children: [],\r\n            //   })\r\n            // }\r\n            // this.folderList[0].children.push({\r\n            //     id: 5,\r\n            //     label: \"摇滚\",\r\n            //     children: [],\r\n            // })\r\n            // console.log(\"测试2：\", this.folderList[0].children[0].label);\r\n            \r\n          } else {\r\n            this.$message.error(\"文件请求失败\");\r\n          }\r\n        });\r\n    },\r\n\r\n    getFullPath(node, path) {\r\n      if (node != null) {\r\n        path = node.parent.data.name + path;\r\n        return this.getFullPath(node.parent, path);\r\n      } else {\r\n        return path;\r\n      }\r\n    },\r\n\r\n    // js递归遍历树形json数据，根据关键字查找节点\r\n    //@leafId  查找的id，\r\n    //@nodes   原始Json数据\r\n    //@path    供递归使用\r\n    findPathByLeafId(leafId, nodes, path) {\r\n      if (path === undefined) {\r\n        path = [];\r\n      }\r\n      for (var i = 0; i < nodes.length; i++) {\r\n        var tmpPath = path.concat();\r\n        tmpPath.push(nodes[i].name);\r\n        if (leafId == nodes[i].name) {\r\n          return tmpPath;\r\n        }\r\n        if (nodes[i].childrenList) {\r\n          var findResult = this.findPathByLeafId(\r\n            leafId,\r\n            nodes[i].childrenList,\r\n            tmpPath\r\n          );\r\n          if (findResult) {\r\n            return findResult;\r\n          }\r\n        }\r\n      }\r\n    },\r\n\r\n    handleNodeClick(e, node) {\r\n      console.log(e, node);\r\n      //   this.selectFolder = e.parent.name.slice(0, e.parent.name.length - 1);\r\n      let path = (\r\n        \"/\" + this.findPathByLeafId(e.name, [this.folderList]).join(\"\")\r\n      ).slice(\r\n        0,\r\n        this.findPathByLeafId(e.name, [this.folderList]).join(\"\").length\r\n      );\r\n      //   console.log(path);\r\n      this.selectFolder = path;\r\n    },\r\n\r\n    // 点击确定的回调\r\n    confirmMove() {\r\n      // 关闭选择框\r\n      this.$emit(\"closeFolderDialog\");\r\n      // 将选中的文件夹名称发给父组件\r\n      this.$emit(\"confirmMove\", {\r\n        path: this.selectFolder,\r\n        type: this.moveType,\r\n      });\r\n    },\r\n  },\r\n  watch: {\r\n    isFolderDialogShow(current) {\r\n      if (current) {\r\n        this.handleFolderList();\r\n      }\r\n    },\r\n  },\r\n  created() {\r\n        \r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.FolderDialog /deep/ .el-dialog {\r\n  border-radius: 10px;\r\n}\r\n\r\n.FolderDialog /deep/ .el-dialog__header {\r\n  border-bottom: 1px solid #eee;\r\n  padding: 10px 20px;\r\n}\r\n\r\n.FolderDialog /deep/ .el-dialog__title {\r\n  font-size: 15px;\r\n  color: rgb(95, 95, 95);\r\n}\r\n\r\n.FolderDialog /deep/ .el-dialog__body {\r\n  height: 100px;\r\n  /* overflow-y: scroll; */\r\n  padding: 15px;\r\n}\r\n\r\n.FolderDialog /deep/ .el-tree-node__content {\r\n  height: 30px;\r\n}\r\n\r\n.FolderDialog /deep/ .el-tree-node__content:hover {\r\n  background-color: #f0f0fc;\r\n}\r\n\r\n.FolderDialog /deep/ .is-current > .el-tree-node__content {\r\n  background-color: #e6e6f5;\r\n}\r\n\r\n.cancel:hover {\r\n  background-color: white;\r\n  color: #696bcc;\r\n  border-color: #a8a9d4;\r\n}\r\n\r\n.confirm {\r\n  background-color: #7c7dd1;\r\n  border-color: #7c7dd1;\r\n  color: white;\r\n}\r\n\r\n.confirm:hover {\r\n  background-color: #6d6fce;\r\n}\r\n\r\n.FolderDialog /deep/ .el-button:focus {\r\n  background-color: #7c7dd1 !important;\r\n  color: white !important;\r\n  border-color: #7c7dd1 !important;\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}