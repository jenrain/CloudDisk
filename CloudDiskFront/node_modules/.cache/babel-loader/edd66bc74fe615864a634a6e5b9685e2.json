{"ast":null,"code":"import { handleLongString } from \"../plugins/utils.js\";\nexport default {\n  name: \"Attribute\",\n  props: {\n    // 当前查看属性的文件的id\n    fileId: {\n      type: Number,\n\n      default() {\n        return \"\";\n      }\n\n    },\n    attributeTop: {\n      type: Number,\n\n      default() {\n        return 0;\n      }\n\n    },\n    attributeLeft: {\n      type: Number,\n\n      default() {\n        return 0;\n      }\n\n    }\n  },\n\n  data() {\n    return {\n      fileInfo: {}\n    };\n  },\n\n  methods: {\n    //   请求\n    // 根据id查看当前文件的属性\n    async getFileAttribute() {\n      console.log(\"当前文件的信息：\", this.fileId); // let res = await this.$request(\n      //   `/educenter/file/getFileInfo/${this.fileId}`\n      // );\n      // console.log(res);\n      // this.fileInfo = res.data.data.file[0];\n    },\n\n    // 点击关闭按钮的回调\n    closeAttribute() {\n      this.fileInfo = {};\n      this.$emit(\"closeAtrribute\");\n    },\n\n    // 拖动属性框的回调\n    moveDialog(e) {\n      // console.log(e);\n      // console.log([e.target]);\n      let dialog;\n\n      if (e.target.className != \"Attribute\") {\n        dialog = e.target.parentNode;\n      } else {\n        return;\n      } //算出鼠标相对元素的位置\n\n\n      let disX = e.clientX - dialog.offsetLeft;\n      let disY = e.clientY - dialog.offsetTop;\n      let pageWidth = document.body.clientWidth;\n      let pageHeight = document.body.clientHeight; // console.log(pageWidth, pageHeight);\n\n      document.onmousemove = e => {\n        // console.log(e);\n        //用鼠标的位置减去鼠标相对元素的位置，得到元素的位置\n        let left = e.clientX - disX;\n        let top = e.clientY - disY;\n        top = top < 100 ? 100 : top;\n        top = top > pageHeight - 225 ? pageHeight - 225 : top;\n        left = left < 245 ? 245 : left;\n        left = left > pageWidth - 325 ? pageWidth - 325 : left; // console.log(top, left);\n        //移动当前元素\n\n        dialog.style.left = left + \"px\";\n        dialog.style.top = top + \"px\";\n      }; // 鼠标松开时清空事件\n\n\n      document.onmouseup = () => {\n        document.onmousemove = null;\n        document.onmouseup = null;\n      };\n    }\n\n  },\n\n  created() {},\n\n  watch: {// fileId() {\n    //   this.getFileAttribute();\n    // },\n  },\n  filters: {\n    handleLongString\n  }\n};","map":{"version":3,"mappings":"AAqDA;AAEA;EACAA,iBADA;EAEAC;IACA;IACAC;MACAC,YADA;;MAEAC;QACA;MACA;;IAJA,CAFA;IAQAC;MACAF,YADA;;MAEAC;QACA;MACA;;IAJA,CARA;IAcAE;MACAH,YADA;;MAEAC;QACA;MACA;;IAJA;EAdA,CAFA;;EAuBAG;IACA;MACAC;IADA;EAGA,CA3BA;;EA4BAC;IACA;IACA;IACA;MACAC,qCADA,CAEA;MACA;MACA;MACA;MACA;IACA,CAVA;;IAYA;IACAC;MACA;MACA;IACA,CAhBA;;IAkBA;IACAC;MACA;MACA;MACA;;MACA;QACAC;MACA,CAFA,MAEA;QACA;MACA,CARA,CASA;;;MACA;MACA;MACA;MACA,4CAbA,CAcA;;MACAC;QACA;QACA;QACA;QACA;QAEAC;QACAA;QACAC;QACAA,uDATA,CAUA;QAEA;;QACAH;QACAA;MACA,CAfA,CAfA,CA+BA;;;MACAC;QACAA;QACAA;MACA,CAHA;IAIA;;EAvDA,CA5BA;;EAqFAG,YArFA;;EAsFAC,QACA;IACA;IACA;EAHA,CAtFA;EA2FAC;IACAC;EADA;AA3FA","names":["name","props","fileId","type","default","attributeTop","attributeLeft","data","fileInfo","methods","console","closeAttribute","moveDialog","dialog","document","top","left","created","watch","filters","handleLongString"],"sourceRoot":"src/components","sources":["Attribute.vue"],"sourcesContent":["<template>\r\n  <div\r\n    class=\"Attribute\"\r\n    v-if=\"fileInfo.id\"\r\n    @mousedown=\"moveDialog\"\r\n    :style=\"{\r\n      top: attributeTop + 'px',\r\n      left: attributeLeft + 'px',\r\n    }\"\r\n  >\r\n    <div class=\"header\">\r\n      {{\r\n        (fileInfo.name + \".\" + fileInfo.type + \" 属性\")\r\n          | handleLongString(10, 15)\r\n      }}\r\n      <i class=\"iconfont icon-close\" @click=\"closeAttribute\"></i>\r\n    </div>\r\n    <div class=\"group\">\r\n      <div class=\"groupItem\">\r\n        <span class=\"left\">文件类型:</span>\r\n        <span class=\"right\">{{\r\n          fileInfo.filetype + \"(.\" + fileInfo.type + \")\"\r\n        }}</span>\r\n      </div>\r\n    </div>\r\n    <div class=\"group\">\r\n      <div class=\"groupItem\">\r\n        <span class=\"left\">位置:</span>\r\n        <span class=\"right\">{{ fileInfo.fdir }}</span>\r\n      </div>\r\n      <div class=\"groupItem\">\r\n        <span class=\"left\">大小:</span>\r\n        <span class=\"right\">{{\r\n          fileInfo.size == null\r\n            ? \"未知大小\"\r\n            : (fileInfo.size / 1048576).toFixed(2) + \" MB\"\r\n        }}</span>\r\n      </div>\r\n    </div>\r\n    <div class=\"group\">\r\n      <div class=\"groupItem\">\r\n        <span class=\"left\">创建时间:</span>\r\n        <span class=\"right\">{{ fileInfo.gmtCreate }}</span>\r\n      </div>\r\n      <div class=\"groupItem\">\r\n        <span class=\"left\">修改时间:</span>\r\n        <span class=\"right\">{{ fileInfo.gmtModified }}</span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { handleLongString } from \"../plugins/utils.js\";\r\n\r\nexport default {\r\n  name: \"Attribute\",\r\n  props: {\r\n    // 当前查看属性的文件的id\r\n    fileId: {\r\n      type: Number,\r\n      default() {\r\n        return \"\";\r\n      },\r\n    },\r\n    attributeTop: {\r\n      type: Number,\r\n      default() {\r\n        return 0;\r\n      },\r\n    },\r\n    attributeLeft: {\r\n      type: Number,\r\n      default() {\r\n        return 0;\r\n      },\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      fileInfo: {},\r\n    };\r\n  },\r\n  methods: {\r\n    //   请求\r\n    // 根据id查看当前文件的属性\r\n    async getFileAttribute() {\r\n      console.log(\"当前文件的信息：\", this.fileId);\r\n      // let res = await this.$request(\r\n      //   `/educenter/file/getFileInfo/${this.fileId}`\r\n      // );\r\n      // console.log(res);\r\n      // this.fileInfo = res.data.data.file[0];\r\n    },\r\n\r\n    // 点击关闭按钮的回调\r\n    closeAttribute() {\r\n      this.fileInfo = {};\r\n      this.$emit(\"closeAtrribute\");\r\n    },\r\n\r\n    // 拖动属性框的回调\r\n    moveDialog(e) {\r\n      // console.log(e);\r\n      // console.log([e.target]);\r\n      let dialog;\r\n      if (e.target.className != \"Attribute\") {\r\n        dialog = e.target.parentNode;\r\n      } else {\r\n        return;\r\n      }\r\n      //算出鼠标相对元素的位置\r\n      let disX = e.clientX - dialog.offsetLeft;\r\n      let disY = e.clientY - dialog.offsetTop;\r\n      let pageWidth = document.body.clientWidth;\r\n      let pageHeight = document.body.clientHeight;\r\n      // console.log(pageWidth, pageHeight);\r\n      document.onmousemove = (e) => {\r\n        // console.log(e);\r\n        //用鼠标的位置减去鼠标相对元素的位置，得到元素的位置\r\n        let left = e.clientX - disX;\r\n        let top = e.clientY - disY;\r\n\r\n        top = top < 100 ? 100 : top;\r\n        top = top > pageHeight - 225 ? pageHeight - 225 : top;\r\n        left = left < 245 ? 245 : left;\r\n        left = left > pageWidth - 325 ? pageWidth - 325 : left;\r\n        // console.log(top, left);\r\n\r\n        //移动当前元素\r\n        dialog.style.left = left + \"px\";\r\n        dialog.style.top = top + \"px\";\r\n      };\r\n      // 鼠标松开时清空事件\r\n      document.onmouseup = () => {\r\n        document.onmousemove = null;\r\n        document.onmouseup = null;\r\n      };\r\n    },\r\n  },\r\n  created() {},\r\n  watch: {\r\n    // fileId() {\r\n    //   this.getFileAttribute();\r\n    // },\r\n  },\r\n  filters: {\r\n    handleLongString,\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.Attribute {\r\n  box-shadow: 0px 0px 10px 1px rgba(0, 0, 0, 0.1);\r\n  border: 1px solid #eee;\r\n  padding-bottom: 10px;\r\n  border-radius: 10px;\r\n  width: 300px;\r\n  font-size: 14px;\r\n  /* position: fixed; */\r\n  background-color: #fff;\r\n  z-index: 100;\r\n}\r\n\r\n.header {\r\n  padding: 15px;\r\n  position: relative;\r\n  cursor: move;\r\n  user-select: none;\r\n}\r\n\r\n.header i {\r\n  position: absolute;\r\n  right: 10px;\r\n  color: rgb(124, 124, 124);\r\n  cursor: pointer;\r\n}\r\n\r\n.group {\r\n  padding: 5px 0;\r\n  margin: 0 15px;\r\n  border-top: 1px solid #ddd;\r\n}\r\n\r\n.groupItem {\r\n  padding: 5px 0;\r\n  display: flex;\r\n}\r\n\r\n.groupItem .left {\r\n  width: 80px;\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}